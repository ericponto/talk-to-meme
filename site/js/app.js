var SpeechRecognition=window.SpeechRecognition||window.webkitSpeechRecognition,app=angular.module("TextToMeme",[]);app.controller("MemeCtrl",function($scope,$http){if($scope.memes=[],$scope.started=!1,$scope.tempTranscript="Press Start, then just talk",$scope.error="","undefined"==typeof SpeechRecognition)$scope.error="Talk to Meme requires the Speech Recognition API, which is not supported by your browser. Right now Google Chrome is the only supported browser.";else{var a=new SpeechRecognition;a.continuous=!0,a.interimResults=!0;var b=function(a){var b=Math.floor(a.length/2),c=a.slice(0,b).join(" "),d=a.slice(b).join(" "),e=a.sort(function(a,b){return b.length-a.length})[0];$http.get("/search/"+e).success(function(a){$scope.memes.unshift({topText:c,bottomText:d,imageUrl:a.result[0].imageUrl})})};a.onresult=function(a){for(var c=a.resultIndex,d=a.results.length,e="",f="";d>c;c++)a.results[c].isFinal?f+=a.results[c][0].transcript:e+=a.results[c][0].transcript;if(e.length&&($scope.tempTranscript=e),f.length){var g=f.split(" ");if(g.length>7){var h=Math.floor(g.length/2);b(g.slice(h)),b(g.slice(0,h))}else b(g)}},a.onerror=function(a){$scope.error="Error: "+a.error,$scope.started=!1},a.onend=function(){$scope.started=!1},$scope.startRecording=function(){a.start(),$scope.started=!0,$scope.error=""},$scope.stopRecording=function(){a.stop(),$scope.started=!1}}});